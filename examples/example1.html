<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Corrected objectPropValidator Example</title>
</head>
<body>
    <h1>Demonstration of the Corrected Validator</h1>
    <p>Check the browser's developer console for output.</p>

    <script>
        // Paste the corrected objectPropValidator function here...
        function objectPropValidator(schema, config = {}) { /* ... full code from above ... */ }

        // --- 1. Define the validation schema ---
        const userValidator = objectPropValidator({
            name: {
                type: String,
                required: true,
            },
            age: {
                type: Number,
                required: true,
                validator(value) {
                    const isValid = value > 18;
                    if (!isValid) {
                        console.error(`[Validation Error] Custom check for 'age' failed. Must be over 18.`);
                    }
                    return isValid;
                },
            },
        });

        const schema = {
            props: {
                type: Object,
                required: true,
                validator: objectPropValidator({
                    user: {
                        type: Object,
                        required: true,
                        validator: userValidator, // Use the nested validator
                    },
                }),
            },
        };

        // --- 2. Create the main validator ---
        const myValidator = objectPropValidator(schema, { logLevel: 'error' });


        // --- 3. Test with VALID data ---
        console.log("--- TESTING VALID DATA ---");
        const validData = {
            props: {
                user: {
                    name: "Mamedul Islam",
                    age: 26
                }
            }
        };
        const isValid = myValidator(validData);
        console.log("Validation Result:", isValid); // Should be true


        // --- 4. Test with INVALID data ---
        console.log("\n--- TESTING INVALID DATA ---");
        const invalidData = {
            props: {
                user: {
                    name: 123,     // Wrong type
                    age: 17        // Fails custom validator
                }
            }
        };
        const isInvalidValid = myValidator(invalidData);
        console.log("Validation Result:", isInvalidValid); // Should be false
        // Console will show specific errors for 'name' and 'age'.

    </script>
</body>
</html>